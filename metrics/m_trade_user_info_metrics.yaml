version: 1
type: metrics_view

display_name: User Info Metrics
model: m_trade_user_info
timeseries: create_time

dimensions:
  - name: id
    display_name: ID
    column: id

  - name: email
    display_name: Email
    column: email

  - name: status
    display_name: Status
    column: status

  - name: domain
    display_name: Domain
    column: "domain"

  - name: pt
    display_name: PT
    column: pt

measures:
  - name: total_users
    display_name: 总用户数
    expression: COUNT(*)
    format_preset: humanize

  - name: total_domains
    display_name: 域名数
    expression: COUNT(DISTINCT "domain")
    format_preset: humanize

  - name: total_emails
    display_name: 邮箱数
    expression: COUNT(DISTINCT email)
    format_preset: humanize

  - name: active_users
    display_name: 活跃用户数
    expression: SUM(CASE WHEN status = 'active' THEN 1 ELSE 0 END)
    format_preset: humanize

  - name: total_api_count
    display_name: 总API调用数
    expression: SUM(api_count)
    format_preset: humanize

  - name: total_web_task_count
    display_name: 总Web任务数
    expression: SUM(web_task_count)
    format_preset: humanize

  - name: total_web_balance
    display_name: 总Web余额
    expression: SUM(web_balance)
    format_preset: humanize

  - name: total_api_balance
    display_name: 总API余额
    expression: SUM(api_balance)
    format_preset: humanize

  - name: total_web_frozen
    display_name: 总Web冻结金额
    expression: SUM(web_frozen)
    format_preset: humanize

  - name: total_api_frozen
    display_name: 总API冻结金额
    expression: SUM(api_frozen)
    format_preset: humanize
