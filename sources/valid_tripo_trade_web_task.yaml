type: model
materialize: true
connector: athena
refresh:
  cron: '0 8 * * *'    
sql: |
  SELECT 
    task_id,
    sub_id,
    email,
    status,
    type,
    client_id,
    CAST(create_time AS timestamp(3)) as create_time,
    CAST(start_time AS timestamp(3)) as start_time,
    "domain",
    running_time,
    pending_time,
    model_version,
    error_code,
    error_message,
    fail_info,
    prompt,
    negative_prompt,
    style,
    texture_quality,
    geometry_quality,
    orientation,
    quad,
    face_limit,
    animation,
    render_video,
    out_format,
    storage_key,
    storage_bucket,
    pt
  FROM silver.valid_tripo_trade_web_task
       WHERE cast(date_parse(pt,'%Y%m%d')as date)  >= DATE_ADD('month', -12, CURRENT_DATE)

